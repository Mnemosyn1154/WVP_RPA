# 투자문서 생성기 PRD (Product Requirements Document)

## 📋 1. 프로젝트 개요

### 1.1 목적
VC(벤처캐피털) 투자 업무에서 반복적으로 작성되는 Term Sheet와 예비투심위 보고서를 자동화하여 업무 효율성을 극대화

### 1.2 배경
- **현재 상황**: Term Sheet와 예비투심위 보고서를 100% 수작업으로 작성
- **문제점**: 반복 작업, 휴먼 에러, 시간 소요, 일관성 부족
- **개선 방향**: 웹 기반 자동화 시스템으로 업무 효율성 극대화

### 1.3 목표
- **주 목표**: 투자 문서 생성 시간 90% 단축 (60분 → 6분)
- **부 목표**: 문서 일관성 확보, 오타/누락 방지, 팀원 접근성 향상

## 🎯 2. 핵심 기능 요구사항

### 2.1 데이터 입력 시스템
**기능**: 확장 가능한 투자 변수 입력 폼

**핵심 설계 원칙**:
- **확장성 우선**: 새로운 변수 추가가 용이한 구조
- **설정 기반**: 하드코딩 최소화, JSON 설정 파일 활용
- **유연한 검증**: 변수별 독립적인 유효성 검증 규칙

**현재 변수 (21개)**:
- **회사 기본 정보** (5개): 투자대상, 대표자, 주소, Series, 사용용도
- **투자 조건** (8개): 투자금액, 투자재원, 투자방식, 투자단가, 액면가, 투자전가치, 투자후가치, 동반투자자
- **재무 정보** (5개): 인수주식수, 지분율, 상환이자, 잔여분배이자, 주매청이자
- **운영 정보** (3개): 배당률, 위약벌, 담당자/투자총괄

**확장성 요구사항**:
- 변수 추가/삭제/수정이 코드 변경 없이 가능
- 그룹핑 및 카테고리 변경 지원
- 조건부 필드 표시 (예: Series A일 때만 특정 필드 표시)
- 계산 공식 동적 설정 (예: 새로운 지분율 계산 방식)

**UX 요구사항**:
- 실시간 데이터 유효성 검증
- 자동 계산 기능 (인수주식수 = 투자금액 ÷ 투자단가)
- 필수/선택 필드 구분
- 데이터 임시 저장 기능 (로컬스토리지)

### 2.2 템플릿 관리 시스템
**기능**: 동적 템플릿 및 변수 관리 시스템

**확장성 중심 설계**:
- **템플릿 추가**: 새로운 문서 타입 쉽게 추가 가능
- **변수 매핑**: 설정 파일 기반 동적 변수 관리
- **버전 관리**: 템플릿 업데이트 히스토리 추적
- **미사용 변수 감지**: 템플릿에 없는 변수 자동 식별

**현재 템플릿**:
- `TermSheet_Template.docx` - 21개 변수 매핑
- `예비투심위_Template.docx` - 15개 변수 매핑

**변수 관리 요구사항**:
- JSON 설정으로 변수-템플릿 매핑 관리
- 변수명 변경 시 자동 일괄 업데이트
- 신규 변수 추가 시 템플릿 업데이트 가이드 제공
- 변수 사용 현황 리포트 (어떤 템플릿에서 사용되는지)

**기술 요구사항**:
- 라이브러리: `docxtemplater` 또는 `docx-templates`
- 변수 형식: `[투자대상]`, `[대표자]` 등 대괄호 표기
- 오류 처리: 누락된 변수, 템플릿 손상 대응

### 2.3 문서 생성 및 다운로드
**기능**: 수정된 Word 문서 생성 및 다운로드

**세부 요구사항**:
- **파일명 규칙**: `YYYYMMDD_[회사명]_[문서타입].docx`
- **생성 옵션**: Term Sheet만, 예비투심위만, 전체 문서
- **다운로드 방식**: ZIP 파일 또는 개별 파일
- **처리 시간**: 3초 이내 완료

## 🔧 3. 기술 사양

### 3.1 프론트엔드
**기술 스택**:
- **HTML5**: 시맨틱 마크업
- **CSS3**: 반응형 디자인, 모던 UI
- **Vanilla JavaScript**: 외부 의존성 최소화

**호환성**:
- Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- 모바일 브라우저 지원 (태블릿 중심)

### 3.2 문서 처리
**라이브러리 옵션**:
1. **docxtemplater** (추천)
   - 장점: 성숙한 라이브러리, 다양한 변수 타입 지원
   - 단점: 상용 라이센스 필요 (고급 기능)

2. **docx-templates**
   - 장점: MIT 라이센스, 가벼움
   - 단점: 기능 제한적

3. **직접 구현**
   - 장점: 완전한 커스터마이징
   - 단점: 개발 복잡도 증가

### 3.3 파일 저장 및 관리
**방식**: 브라우저 내 처리 (서버리스)
- 템플릿 파일: Base64 인코딩하여 JavaScript에 내장
- 사용자 데이터: 로컬스토리지 활용
- 생성 파일: 즉시 다운로드, 서버 저장 없음

## 🎨 4. UI/UX 디자인 요구사항

### 4.1 디자인 컨셉
**스타일**: 모던, 미니멀, 전문적
**색상**: 금융/투자 업계에 적합한 차분한 톤
**레이아웃**: 단일 페이지 애플리케이션 (SPA)

### 4.2 레이아웃 구조
```
📱 헤더: 로고, 제목, 버전 정보
📝 입력 폼: 4개 섹션으로 구분된 21개 필드
⚡ 액션 버튼: 미리보기, Term Sheet 생성, 예비투심위 생성, 전체 생성
📊 상태 표시: 진행률, 오류 메시지, 성공 알림
```

### 4.3 반응형 설계
- **데스크톱** (1200px+): 3열 그리드 레이아웃
- **태블릿** (768-1199px): 2열 그리드 레이아웃  
- **모바일** (767px-): 1열 스택 레이아웃

## 🚀 5. 상세 개발 일정 및 Task Breakdown

### 5.1 Phase 1: 기반 인프라 구축 (Week 1)

#### **Task 1.1: 프로젝트 설정 및 구조 설계 (1일)**
- [ ] **1.1.1** 프로젝트 폴더 구조 생성
  ```
  📁 investment-doc-generator/
  ├── 📁 src/
  │   ├── 📁 components/     # UI 컴포넌트
  │   ├── 📁 config/         # 설정 파일
  │   ├── 📁 templates/      # 템플릿 파일
  │   ├── 📁 utils/          # 유틸리티 함수
  │   └── 📁 assets/         # 정적 자원
  ├── 📁 tests/              # 테스트 파일
  └── 📄 index.html          # 메인 페이지
  ```
- [ ] **1.1.2** package.json 설정 및 의존성 정의
- [ ] **1.1.3** 개발 환경 설정 (Live Server, 번들러)
- [ ] **1.1.4** Git 저장소 초기화 및 .gitignore 설정

#### **Task 1.2: 설정 기반 시스템 구축 (2일)**
- [ ] **1.2.1** 변수 설정 JSON 스키마 설계
  ```json
  {
    "variables": {
      "company_info": {
        "투자대상": {
          "type": "text",
          "required": true,
          "validation": "^.{1,50}$",
          "placeholder": "회사명을 입력하세요"
        }
      }
    }
  }
  ```
- [ ] **1.2.2** 템플릿 매핑 설정 JSON 생성
- [ ] **1.2.3** 설정 파일 로더 유틸리티 구현
- [ ] **1.2.4** 동적 폼 생성 엔진 기반 구조 설계

#### **Task 1.3: UI/UX 프레임워크 구축 (2일)**
- [ ] **1.3.1** CSS 변수 및 디자인 시스템 정의
  - 색상 팔레트, 타이포그래피, 간격 체계
- [ ] **1.3.2** 반응형 그리드 시스템 구현
- [ ] **1.3.3** 공통 컴포넌트 클래스 개발
  - FormField, Button, Modal, Toast 등
- [ ] **1.3.4** 접근성 (ARIA) 기본 구조 적용

### 5.2 Phase 2: 입력 시스템 구현 (Week 2)

#### **Task 2.1: 동적 폼 생성 엔진 (3일)**
- [ ] **2.1.1** 설정 기반 폼 필드 생성기 구현
  ```javascript
  class FormGenerator {
    generateField(config) { /* 설정에 따른 필드 생성 */ }
    renderSection(sectionConfig) { /* 섹션별 렌더링 */ }
  }
  ```
- [ ] **2.1.2** 필드 타입별 렌더링 로직
  - text, number, select, textarea, date 등
- [ ] **2.1.3** 그룹핑 및 섹션 관리 시스템
- [ ] **2.1.4** 조건부 필드 표시/숨김 로직

#### **Task 2.2: 데이터 유효성 검증 (2일)**
- [ ] **2.2.1** 실시간 유효성 검증 엔진
  ```javascript
  class Validator {
    validateField(value, rules) { /* 필드별 검증 */ }
    validateForm(formData) { /* 전체 폼 검증 */ }
  }
  ```
- [ ] **2.2.2** 에러 메시지 표시 시스템
- [ ] **2.2.3** 성공 상태 피드백 구현
- [ ] **2.2.4** 한글 입력 특수 처리 (IME 이벤트)

#### **Task 2.3: 자동 계산 시스템 (2일)**
- [ ] **2.3.1** 계산 공식 엔진 설계
  ```javascript
  const calculations = {
    '인수주식수': (data) => data.투자금액 / data.투자단가,
    '지분율': (data) => (data.투자금액 / data.투자후가치) * 100
  };
  ```
- [ ] **2.3.2** 의존성 그래프 구현 (필드 간 종속성 관리)
- [ ] **2.3.3** 실시간 계산 결과 업데이트
- [ ] **2.3.4** 계산 오류 처리 및 디버깅 도구

### 5.3 Phase 3: 템플릿 처리 엔진 (Week 3)

#### **Task 3.1: docx 라이브러리 통합 (2일)**
- [ ] **3.1.1** docxtemplater vs docx-templates 성능 비교 테스트
- [ ] **3.1.2** 선택된 라이브러리 설치 및 기본 설정
- [ ] **3.1.3** 한글 폰트 및 인코딩 처리
- [ ] **3.1.4** 브라우저 호환성 테스트 (Chrome, Firefox, Safari)

#### **Task 3.2: 변수 치환 엔진 (3일)**
- [ ] **3.2.1** 템플릿 파일 Base64 인코딩 및 내장
- [ ] **3.2.2** 변수 매핑 처리 로직
  ```javascript
  class TemplateProcessor {
    loadTemplate(templateName) { /* 템플릿 로드 */ }
    replaceVariables(template, data) { /* 변수 치환 */ }
    generateDocument(templateName, data) { /* 문서 생성 */ }
  }
  ```
- [ ] **3.2.3** 에러 처리 (누락 변수, 잘못된 형식 등)
- [ ] **3.2.4** 변수 사용 현황 분석 도구

#### **Task 3.3: 파일 생성 및 다운로드 (2일)**
- [ ] **3.3.1** 파일명 생성 규칙 구현
- [ ] **3.3.2** 단일/복수 파일 다운로드 처리
- [ ] **3.3.3** ZIP 압축 기능 (전체 문서 생성 시)
- [ ] **3.3.4** 진행률 표시 및 사용자 피드백

### 5.4 Phase 4: 데이터 관리 및 최적화 (Week 4)

#### **Task 4.1: 데이터 저장 시스템 (2일)**
- [ ] **4.1.1** LocalStorage 데이터 관리자 구현
  ```javascript
  class DataManager {
    saveData(key, data) { /* 데이터 저장 */ }
    loadData(key) { /* 데이터 로드 */ }
    exportData() { /* JSON 내보내기 */ }
    importData(jsonFile) { /* JSON 가져오기 */ }
  }
  ```
- [ ] **4.1.2** 자동 저장 기능 (5초마다)
- [ ] **4.1.3** 데이터 복구 시스템
- [ ] **4.1.4** 데이터 내보내기/가져오기 (JSON, CSV)

#### **Task 4.2: 성능 최적화 (2일)**
- [ ] **4.2.1** 번들 크기 최적화 (템플릿 파일 압축)
- [ ] **4.2.2** 메모리 사용량 모니터링 및 최적화
- [ ] **4.2.3** 대용량 파일 처리 최적화
- [ ] **4.2.4** 로딩 성능 개선 (레이지 로딩, 캐싱)

#### **Task 4.3: 사용자 경험 개선 (3일)**
- [ ] **4.3.1** 미리보기 기능 구현
- [ ] **4.3.2** 키보드 단축키 지원
- [ ] **4.3.3** 도움말 및 가이드 시스템
- [ ] **4.3.4** 다크 모드 지원

### 5.5 Phase 5: 테스트 및 배포 (Week 5)

#### **Task 5.1: 통합 테스트 (3일)**
- [ ] **5.1.1** 실제 데이터로 End-to-End 테스트
- [ ] **5.1.2** 브라우저별 호환성 테스트
- [ ] **5.1.3** 성능 벤치마크 테스트
- [ ] **5.1.4** 사용자 시나리오 테스트

#### **Task 5.2: 배포 및 문서화 (2일)**
- [ ] **5.2.1** 프로덕션 빌드 최적화
- [ ] **5.2.2** 사용자 매뉴얼 작성
- [ ] **5.2.3** 개발자 문서 작성
- [ ] **5.2.4** 배포 및 팀 온보딩

## ✅ 6. 수용 기준

### 6.1 기능 검증
- [ ] 21개 모든 변수가 정확히 치환되어야 함
- [ ] 생성된 문서가 기존 템플릿과 100% 동일한 포맷을 유지
- [ ] 파일명이 규칙에 따라 정확히 생성되어야 함
- [ ] 3초 이내 문서 생성 완료

### 6.2 품질 기준
- [ ] 모든 주요 브라우저에서 정상 동작
- [ ] 한글 입력 및 처리 완벽 지원
- [ ] 사용자 오류에 대한 명확한 안내 메시지
- [ ] 생성된 문서가 MS Word에서 정상 열림

### 6.3 사용성 기준
- [ ] 비개발자도 5분 내 사용법 습득 가능
- [ ] 실제 투자 업무에서 오류 없이 사용 가능
- [ ] 기존 VBA 방식 대비 시간 단축 확인

## 🔧 7. 기술적 고려사항

### 7.1 확장성 아키텍처
**설정 기반 시스템**:
- 모든 변수와 템플릿 매핑을 JSON 설정 파일로 관리
- 하드코딩 최소화로 변경 사항에 대한 유연한 대응
- 플러그인 방식의 확장 가능한 구조

**변수 관리 시스템**:
```json
{
  "version": "1.0",
  "variables": {
    "회사정보": {
      "투자대상": {
        "type": "text",
        "required": true,
        "maxLength": 50,
        "templateMapping": ["[투자대상]", "[회사명]"]
      }
    }
  },
  "calculations": {
    "인수주식수": {
      "formula": "투자금액 / 투자단가",
      "dependencies": ["투자금액", "투자단가"]
    }
  }
}
```

**템플릿 확장성**:
- 새로운 문서 타입 추가 시 설정 파일만 수정
- 변수 추가/삭제 시 자동 영향도 분석
- 템플릿 버전 간 호환성 체크

### 7.2 변경 관리 프로세스
**변수 추가 프로세스**:
1. 설정 파일에 새 변수 정의
2. 템플릿 파일에 변수 추가
3. 자동 검증으로 누락 확인
4. 기존 데이터 마이그레이션

**템플릿 업데이트 프로세스**:
1. 템플릿 변경 사항 감지
2. 영향받는 변수 자동 식별  
3. 업데이트 가이드 제공
4. 백워드 호환성 검증

## 📊 8. 성공 지표

### 8.1 정량적 지표
- **시간 단축률**: 90% 이상 (60분 → 6분)
- **오류 감소율**: 95% 이상 (휴먼 에러 방지)
- **사용률**: 팀원 80% 이상 주 1회 사용
- **생성 성공률**: 99% 이상

### 8.2 정성적 지표
- 팀원 만족도 조사: 4.5/5.0 이상
- 문서 품질 개선 확인
- 업무 효율성 체감 개선

## 🗓️ 9. 상세 마일스톤 및 검증 기준

### Week 1: 기반 인프라 및 설정 시스템
**목표**: 확장 가능한 기반 시스템 구축  
**주요 산출물**:
- [ ] 프로젝트 구조 및 개발 환경
- [ ] 변수 설정 JSON 스키마
- [ ] 동적 폼 생성 기반 구조
- [ ] 반응형 UI 프레임워크

**검증 기준**:
- 새로운 변수 추가가 5분 내 가능
- 설정 파일 수정만으로 폼 구조 변경 확인
- 3개 브라우저에서 UI 정상 렌더링

### Week 2: 입력 시스템 및 검증
**목표**: 완전한 데이터 입력 및 관리 시스템  
**주요 산출물**:
- [ ] 21개 변수 기반 동적 폼
- [ ] 실시간 유효성 검증
- [ ] 자동 계산 엔진
- [ ] 데이터 저장/복구 시스템

**검증 기준**:
- 모든 필드 타입의 정상 동작 확인
- 계산 공식 정확성 검증 (수동 계산과 비교)
- 데이터 손실 없는 자동 저장 확인

### Week 3: 문서 생성 엔진
**목표**: 안정적인 Word 문서 생성 시스템  
**주요 산출물**:
- [ ] docx 처리 라이브러리 통합
- [ ] 변수 치환 엔진
- [ ] 파일 생성 및 다운로드
- [ ] 에러 처리 시스템

**검증 기준**:
- 생성된 문서가 원본 템플릿과 동일한 포맷
- 21개 변수 모두 정확히 치환 확인
- 3초 이내 문서 생성 완료
- MS Word에서 정상 열림 확인

### Week 4: 최적화 및 사용자 경험
**목표**: 프로덕션 수준의 완성도  
**주요 산출물**:
- [ ] 성능 최적화
- [ ] 사용자 경험 개선
- [ ] 미리보기 기능
- [ ] 도움말 시스템

**검증 기준**:
- 초기 로딩 시간 5초 이내
- 대용량 데이터 처리 시 UI 응답성 유지
- 사용자 테스트 만족도 4.0/5.0 이상

### Week 5: 통합 테스트 및 배포
**목표**: 실제 업무 환경에서 사용 가능한 수준  
**주요 산출물**:
- [ ] 종합 테스트 완료
- [ ] 사용자 매뉴얼
- [ ] 배포 버전
- [ ] 팀 온보딩 자료

**검증 기준**:
- 실제 투자 데이터로 문서 생성 성공
- 팀원 5명 이상이 독립적으로 사용 가능
- 생성된 문서의 업무 활용 적합성 확인

---

**승인자**: 차승준  
**작성일**: 2025.06.13  
**버전**: v1.0